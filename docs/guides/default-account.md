# é»˜è®¤ç®¡ç†å‘˜è´¦å·ä¿¡æ¯

## ğŸ“‹ ç™»å½•å‡­æ®

ç³»ç»Ÿåœ¨åˆå§‹åŒ–æ—¶åˆ›å»ºäº†ä¸€ä¸ªé»˜è®¤ç®¡ç†å‘˜è´¦å·ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‡­æ®ç™»å½•ï¼š

### æ–¹å¼ä¸€ï¼šé‚®ç®±ç™»å½•ï¼ˆæ¨èï¼‰
- **é‚®ç®±**ï¼š`admin@supawriter.com`
- **å¯†ç **ï¼š`admin123`

### æ–¹å¼äºŒï¼šç”¨æˆ·åç™»å½•
- **ç”¨æˆ·å**ï¼š`admin`
- **å¯†ç **ï¼š`admin123`

## ğŸ” å¯†ç ä¿¡æ¯

- **æ˜æ–‡å¯†ç **ï¼š`admin123`
- **SHA256 å“ˆå¸Œå€¼**ï¼š`240be518fabd2724ddb6f04eeb1da5967448d7e831c08c8fa822809f74c720a9`

è¯¥å¯†ç å“ˆå¸Œå·²å­˜å‚¨åœ¨æ•°æ®åº“çš„ `users` è¡¨çš„ `password_hash` å­—æ®µä¸­ã€‚

## ğŸ›¡ï¸ å®‰å…¨å»ºè®®

### 1. ç«‹å³ä¿®æ”¹é»˜è®¤å¯†ç 

**æ–¹å¼ä¸€ï¼šé€šè¿‡ä¸ªäººèµ„æ–™é¡µé¢ä¿®æ”¹**
1. ç™»å½•ç³»ç»Ÿ
2. è¿›å…¥"ä¸ªäººèµ„æ–™"æˆ–"Profile"é¡µé¢
3. æ‰¾åˆ°"ä¿®æ”¹å¯†ç "éƒ¨åˆ†
4. è¾“å…¥å½“å‰å¯†ç  `admin123`
5. è¾“å…¥æ–°å¯†ç ï¼ˆè‡³å°‘8ä½ï¼‰
6. ç¡®è®¤æ–°å¯†ç 
7. æäº¤ä¿®æ”¹

**æ–¹å¼äºŒï¼šé€šè¿‡ä»£ç ä¿®æ”¹å¯†ç **
```python
from utils.auth_v2 import AuthService

# ä¿®æ”¹å¯†ç 
success, message = AuthService.change_password(
    user_id=1,  # admin ç”¨æˆ·çš„IDé€šå¸¸æ˜¯1
    old_password="admin123",
    new_password="your_new_secure_password"
)
print(message)
```

### 2. åˆ›å»ºä¸ªäººè´¦å·ï¼ˆæ¨èï¼‰

ä¸å»ºè®®é•¿æœŸä½¿ç”¨é»˜è®¤ç®¡ç†å‘˜è´¦å·ã€‚å»ºè®®ï¼š
1. ç™»å½•ååˆ›å»ºä¸€ä¸ªæ–°çš„ç®¡ç†å‘˜è´¦å·
2. ä½¿ç”¨æ–°è´¦å·è¿›è¡Œæ—¥å¸¸æ“ä½œ
3. ç¦ç”¨æˆ–åˆ é™¤é»˜è®¤ admin è´¦å·

### 3. åˆ é™¤æˆ–ç¦ç”¨é»˜è®¤è´¦å·ï¼ˆå¯é€‰ï¼‰

**ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å**ï¼Œå¯ä»¥è€ƒè™‘åˆ é™¤æˆ–ç¦ç”¨é»˜è®¤è´¦å·ï¼š

```python
from utils.database import User

# æ–¹å¼ä¸€ï¼šç¦ç”¨è´¦å·
User.update_user(1, is_active=False)

# æ–¹å¼äºŒï¼šåˆ é™¤è´¦å·ï¼ˆè°¨æ…æ“ä½œï¼‰
# æ³¨æ„ï¼šéœ€è¦å…ˆç¡®ä¿æœ‰å…¶ä»–ç®¡ç†å‘˜è´¦å·
```

## ğŸ“ æ•°æ®åº“é…ç½®ä½ç½®

é»˜è®¤è´¦å·åœ¨æ•°æ®åº“åˆå§‹åŒ–æ—¶åˆ›å»ºï¼Œé…ç½®æ–‡ä»¶ï¼š
- **åˆå§‹åŒ–è„šæœ¬**ï¼š`deployment/postgres/init/00-init-complete.sql`
- **ç¬¬ 82-85 è¡Œ**ï¼šå®šä¹‰äº†é»˜è®¤ç®¡ç†å‘˜è´¦å·

```sql
-- æ’å…¥é»˜è®¤ç®¡ç†å‘˜è´¦å·ï¼ˆå¯†ç ä¸º: admin123ï¼‰
INSERT INTO users (username, email, password_hash, display_name, is_superuser)
VALUES ('admin', 'admin@supawriter.com', 
        '240be518fabd2724ddb6f04eeb1da5967448d7e831c08c8fa822809f74c720a9', 
        'ç®¡ç†å‘˜', TRUE)
ON CONFLICT (username) DO NOTHING;
```

## ğŸ”„ å¦‚ä½•ç”Ÿæˆæ–°çš„å¯†ç å“ˆå¸Œ

å¦‚æœéœ€è¦ä¿®æ”¹é»˜è®¤å¯†ç æˆ–ç”Ÿæˆæ–°çš„å¯†ç å“ˆå¸Œï¼š

```python
import hashlib

password = "your_new_password"
password_hash = hashlib.sha256(password.encode()).hexdigest()
print(f"å¯†ç : {password}")
print(f"SHA256 å“ˆå¸Œ: {password_hash}")
```

## âš ï¸ é‡è¦æç¤º

1. **é»˜è®¤å¯†ç ä»…ç”¨äºé¦–æ¬¡ç™»å½•**ï¼šè¯·åœ¨é¦–æ¬¡ç™»å½•åç«‹å³ä¿®æ”¹
2. **ä¸è¦åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨é»˜è®¤å¯†ç **ï¼šè¿™æ˜¯å…¬å¼€çš„å®‰å…¨é£é™©
3. **ä½¿ç”¨å¼ºå¯†ç **ï¼šå»ºè®®ä½¿ç”¨è‡³å°‘12ä½ï¼ŒåŒ…å«å¤§å°å†™å­—æ¯ã€æ•°å­—å’Œç‰¹æ®Šå­—ç¬¦çš„å¯†ç 
4. **å®šæœŸæ›´æ¢å¯†ç **ï¼šå»ºè®®å®šæœŸæ›´æ¢ç®¡ç†å‘˜å¯†ç 
5. **å¤‡ä»½é‡è¦æ•°æ®**ï¼šä¿®æ”¹æˆ–åˆ é™¤è´¦å·å‰è¯·ç¡®ä¿æ•°æ®å·²å¤‡ä»½

## ğŸ“ å¦‚æœå¿˜è®°å¯†ç 

å¦‚æœå¿˜è®°å¯†ç ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼é‡ç½®ï¼š

### æ–¹å¼ä¸€ï¼šæ•°æ®åº“ç›´æ¥é‡ç½®

```sql
-- é‡ç½® admin è´¦å·å¯†ç ä¸º admin123
UPDATE users 
SET password_hash = '240be518fabd2724ddb6f04eeb1da5967448d7e831c08c8fa822809f74c720a9'
WHERE username = 'admin';
```

### æ–¹å¼äºŒï¼šPython è„šæœ¬é‡ç½®

```python
from utils.database import User
import hashlib

new_password = "new_password_here"
password_hash = hashlib.sha256(new_password.encode()).hexdigest()

User.update_user(
    user_id=1,  # admin ç”¨æˆ·ID
    password_hash=password_hash
)
print(f"å¯†ç å·²é‡ç½®ä¸º: {new_password}")
```

## ğŸ¯ å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆæ•°æ®åº“é‡Œæœ‰ password_hash ä½†æ— æ³•ç™»å½•ï¼Ÿ

A: æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š
1. ç¡®è®¤ä½¿ç”¨çš„æ˜¯æ­£ç¡®çš„ç™»å½•æ–¹å¼ï¼ˆé‚®ç®±æˆ–ç”¨æˆ·åï¼‰
2. ç¡®è®¤å¯†ç æ˜¯ `admin123`
3. ç¡®è®¤æ•°æ®åº“è¿æ¥æ­£å¸¸ï¼ˆå‚è€ƒ `DATABASE_FIX_SUMMARY.md`ï¼‰
4. æ£€æŸ¥ `is_active` å­—æ®µæ˜¯å¦ä¸º `TRUE`

### Q: å¯ä»¥æœ‰å¤šä¸ªç®¡ç†å‘˜è´¦å·å—ï¼Ÿ

A: å¯ä»¥ã€‚`is_superuser` å­—æ®µä¸º `TRUE` çš„ç”¨æˆ·éƒ½æ˜¯ç®¡ç†å‘˜ã€‚

### Q: OAuth ç™»å½•çš„ç”¨æˆ·æœ‰å¯†ç å—ï¼Ÿ

A: OAuth ç™»å½•çš„ç”¨æˆ·ï¼ˆå¦‚ Googleã€å¾®ä¿¡ç™»å½•ï¼‰çš„ `password_hash` å­—æ®µä¸ºç©ºï¼ˆNULLï¼‰ï¼Œä»–ä»¬åªèƒ½é€šè¿‡å¯¹åº”çš„ OAuth æ–¹å¼ç™»å½•ã€‚

---

**åˆ›å»ºæ—¶é—´**ï¼š2025-11-17  
**æœ€åæ›´æ–°**ï¼š2025-11-17
