# 聊天助手历史记录功能

## 功能概述

聊天助手历史记录功能允许用户保存、加载和管理聊天会话，使得用户可以继续之前的对话。这个功能增强了聊天机器人的用户体验，提供了以下主要特性：

1. **持久化聊天历史**：聊天记录保存到文件系统，在用户会话之间保持不变
2. **聊天会话管理**：创建新会话、重命名会话、删除会话
3. **会话列表**：在侧边栏显示所有可用的聊天会话，包括标题、消息数量和最后更新时间
4. **模型选择**：为每个聊天会话选择不同的语言模型

## 技术实现

### 数据存储

- 聊天历史保存在 `data/chat_history/{username}/` 目录下
- 每个聊天会话作为单独的 JSON 文件存储
- JSON 文件包含会话元数据（标题、创建时间、更新时间）和消息列表

### 核心功能

- **创建聊天会话**：生成唯一ID并初始化空消息列表
- **加载聊天会话**：从文件系统读取特定会话
- **保存聊天会话**：将会话数据写入文件系统
- **更新聊天会话**：添加新消息或修改会话元数据
- **列出聊天会话**：获取用户的所有可用会话
- **删除聊天会话**：从文件系统中移除会话

### 用户界面

- **侧边栏**：显示会话列表和管理功能
  - 创建新会话按钮
  - 会话列表（标题、消息数量、更新时间）
  - 删除会话按钮
  - 重命名会话功能
- **主区域**：聊天界面
  - 消息历史显示
  - 输入框
  - 模型选择

## 使用方法

1. 导航到"聊天助手"页面
2. 在侧边栏中选择现有会话或创建新会话
3. 输入消息并与AI助手交流
4. 会话将自动保存
5. 可以随时重命名或删除会话

## 文件结构

- `page/chatbot.py` - 聊天界面和会话管理UI
- `utils/history_utils.py` - 聊天历史管理功能
- `data/chat_history/{username}/` - 用户聊天会话存储目录

## 未来改进

- 搜索聊天历史功能
- 导出/导入聊天会话
- 按标签或类别组织聊天会话
- 聊天会话共享功能
